;(function($){$.InputClearButtons=function(button,input,options){var $button=$(button);var $input=$(input);var showing=false;$.InputClearButtons.defaultOptions={fadeOpacity:0.5,fadeDuration:300};var options=$.extend({},$.InputClearButtons.defaultOptions,options);function init(){if(inputIsEmpty()){$button.css({opacity:0.0,visibility:'hidden'});}else{$button.css({opacity:1.0,visibility:'visible'});$button.click(onBtnClick);showing=true;};$input.change(onChange).bind('onPropertyChange',onChange).focus(onFocus).bind('cut',onCut).bind('paste',onPaste).blur(onBlur);};function hideButton(){$button.stop().animate({opacity:0},options.fadeDuration,handleVisibilityAfterHideAnim);};function handleVisibilityAfterHideAnim(){showing=false;$button.unbind('click');$button.css({visibility:'hidden'});};function showButton(){$button.css({visibility:'visible'});$button.click(onBtnClick);$button.stop().animate({opacity:1},options.fadeDuration);showing=true;};function onBtnClick(event){if(!inputIsEmpty()){$input.val("");hideButton();$input.focus();}};function onFocus(event){$input.bind('keydown.inputclearBtn',onKeyStroke);};function onBlur(event){$input.unbind('keydown.inputclearBtn');if(inputIsEmpty()){hideButton();}};function onCut(event){if(input.selectionStart===0&&input.selectionEnd==input.value.length){hideButton();}};function onPaste(event){if(inputIsEmpty()){showButton();}};function onChange(event){if(!showing){if(!inputIsEmpty()){showButton();}}else{if(inputIsEmpty()){hideButton();}}};function onKeyStroke(event){if(input.value.length>2)return;switch(event.keyCode){case 16:case 17:case 18:case 19:case 20:case 27:case 34:case 33:case 36:case 35:case 91:case 45:return;break;case 8:case 46:if(input.value.length<=1){$input.unbind('keydown.inputclearBtn');hideButton();$input.bind('keyup.inputclearBtn',rebindkeydown);};return;break;};if(inputIsEmpty()&&!showing){showButton();};};function rebindkeydown(){$input.unbind('keyup.inputclearBtn');$input.bind('keydown.inputclearBtn',onKeyStroke);};function inputIsEmpty(){return input.value.length==0;};init();};$.fn.inputClearButtons=function(options){return this.each(function(){var for_attr=this.getAttribute('for');if(!for_attr)return;var $input=$("input#"+for_attr+"[type='text'],"+"textarea#"+for_attr);if($input.length==0)return;(new $.InputClearButtons(this,$input[0],options));});};})(jQuery);